{"title":"查看SQL执行计划(explain)","slug":"查看SQL执行计划-explain","date":"2023-03-03T06:23:59.000Z","updated":"2023-03-03T06:56:59.256Z","comments":true,"path":"api/articles/查看SQL执行计划-explain.json","excerpt":null,"covers":["F:\\GitDown\\hexo\\source_posts\\查看SQL执行计划-explain.assets\\image-20230303142552512.png"],"content":"<h2><span id=\"查看sql执行计划\">查看SQL执行计划</span></h2><p>**explain：**explain select * from xxx</p>\n<p>当使用<code>explain sql</code>后会看到执行计划</p>\n<p><img src=\"F:\\GitDown\\hexo\\source_posts\\查看SQL执行计划-explain.assets\\image-20230303142552512.png\" alt=\"image-20230303142552512\"></p>\n<table>\n<thead>\n<tr>\n<th>字段</th>\n<th>解释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>id</td>\n<td>每个被独立执行的操作标识，标识对象被操作的顺序，id值越大，先被执行，如果相同，执行顺序从上到下</td>\n</tr>\n<tr>\n<td>select_type</td>\n<td>查询中每个select 字句的类型</td>\n</tr>\n<tr>\n<td>table</td>\n<td>被操作的对象名称，通常是表名，但有其他格式</td>\n</tr>\n<tr>\n<td>partitions</td>\n<td>匹配的分区信息(对于非分区表值为NULL)</td>\n</tr>\n<tr>\n<td>type</td>\n<td>连接操作的类型</td>\n</tr>\n<tr>\n<td>possible_keys</td>\n<td>可能用到的索引</td>\n</tr>\n<tr>\n<td>key</td>\n<td>优化器实际使用的索引(<strong>最重要的列</strong>) 从最好到最差的连接类型为<code>const</code>、<code>eq_reg</code>、<code>ref</code>、<code>range</code>、<code>index</code>和<code>ALL</code>。当出现<code>ALL</code>时表示当前SQL出现了“坏味道”</td>\n</tr>\n<tr>\n<td>key_len</td>\n<td>被优化器选定的索引键长度，单位是字节</td>\n</tr>\n<tr>\n<td>ref</td>\n<td>表示本行被操作对象的参照对象，无参照对象为NULL</td>\n</tr>\n<tr>\n<td>rows</td>\n<td>查询执行所扫描的元组个数（对于innodb，此值为估计值）</td>\n</tr>\n<tr>\n<td>filtered</td>\n<td>条件表上数据被过滤的元组个数百分比</td>\n</tr>\n<tr>\n<td>extra</td>\n<td>执行计划的重要补充信息，当此列出现<code>Using filesort</code> , <code>Using temporary</code> 字样时就要小心了，很可能SQL语句需要优化</td>\n</tr>\n</tbody></table>\n<h3><span id=\"sql优化小结\">SQL优化小结</span></h3><p>这里给大家总结一下优化SQL的套路</p>\n<ol>\n<li>查看执行计划 explain</li>\n<li>如果有告警信息，查看告警信息 show warnings;</li>\n<li>查看SQL涉及的表结构和索引信息</li>\n<li>根据执行计划，思考可能的优化点</li>\n<li>按照可能的优化点执行表结构变更、增加索引、SQL改写等操作</li>\n<li>查看优化后的执行时间和执行计划</li>\n<li>如果优化效果不明显，重复第四步操作</li>\n</ol>\n","more":"<h2 id=\"查看SQL执行计划\"><a href=\"#查看SQL执行计划\" class=\"headerlink\" title=\"查看SQL执行计划\"></a>查看SQL执行计划</h2><p>**explain：**explain select * from xxx</p>\n<p>当使用<code>explain sql</code>后会看到执行计划</p>\n<p><img src=\"F:\\GitDown\\hexo\\source_posts\\查看SQL执行计划-explain.assets\\image-20230303142552512.png\" alt=\"image-20230303142552512\"></p>\n<table>\n<thead>\n<tr>\n<th>字段</th>\n<th>解释</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>id</td>\n<td>每个被独立执行的操作标识，标识对象被操作的顺序，id值越大，先被执行，如果相同，执行顺序从上到下</td>\n</tr>\n<tr>\n<td>select_type</td>\n<td>查询中每个select 字句的类型</td>\n</tr>\n<tr>\n<td>table</td>\n<td>被操作的对象名称，通常是表名，但有其他格式</td>\n</tr>\n<tr>\n<td>partitions</td>\n<td>匹配的分区信息(对于非分区表值为NULL)</td>\n</tr>\n<tr>\n<td>type</td>\n<td>连接操作的类型</td>\n</tr>\n<tr>\n<td>possible_keys</td>\n<td>可能用到的索引</td>\n</tr>\n<tr>\n<td>key</td>\n<td>优化器实际使用的索引(<strong>最重要的列</strong>) 从最好到最差的连接类型为<code>const</code>、<code>eq_reg</code>、<code>ref</code>、<code>range</code>、<code>index</code>和<code>ALL</code>。当出现<code>ALL</code>时表示当前SQL出现了“坏味道”</td>\n</tr>\n<tr>\n<td>key_len</td>\n<td>被优化器选定的索引键长度，单位是字节</td>\n</tr>\n<tr>\n<td>ref</td>\n<td>表示本行被操作对象的参照对象，无参照对象为NULL</td>\n</tr>\n<tr>\n<td>rows</td>\n<td>查询执行所扫描的元组个数（对于innodb，此值为估计值）</td>\n</tr>\n<tr>\n<td>filtered</td>\n<td>条件表上数据被过滤的元组个数百分比</td>\n</tr>\n<tr>\n<td>extra</td>\n<td>执行计划的重要补充信息，当此列出现<code>Using filesort</code> , <code>Using temporary</code> 字样时就要小心了，很可能SQL语句需要优化</td>\n</tr>\n</tbody></table>\n<h3 id=\"SQL优化小结\"><a href=\"#SQL优化小结\" class=\"headerlink\" title=\"SQL优化小结\"></a>SQL优化小结</h3><p>这里给大家总结一下优化SQL的套路</p>\n<ol>\n<li>查看执行计划 explain</li>\n<li>如果有告警信息，查看告警信息 show warnings;</li>\n<li>查看SQL涉及的表结构和索引信息</li>\n<li>根据执行计划，思考可能的优化点</li>\n<li>按照可能的优化点执行表结构变更、增加索引、SQL改写等操作</li>\n<li>查看优化后的执行时间和执行计划</li>\n<li>如果优化效果不明显，重复第四步操作</li>\n</ol>\n","categories":[{"name":"SQL优化","path":"api/categories/SQL优化.json"}],"tags":[{"name":"数据库","path":"api/tags/数据库.json"}]}